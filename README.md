# gemini_nest_js_api

This is a NestJS-based API that integrates with Google's Gemini AI.

## üöÄ Getting Started

### Prerequisites

*   Node.js (v18 or higher)
*   npm or yarn

### 1. Installation

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/joirki/orion-gem-nest-api.git
    cd orion-gem-nest-api
    ```

2.  **Install dependencies:**
    ```bash
    npm install
    ```

3.  **Set up environment variables:**
    Create a `.env` file in the root of the project and add the necessary environment variables. You can use `.env.template` as a reference.
    ```bash
    cp .env.template .env
    ```
    Then, edit the `.env` file to add your Gemini API key:
    ```
    GEMINI_API_KEY=your_api_key_here
    ```

### 2. Running the Application

*   **Development mode:**
    ```bash
    npm run start:dev
    ```
    This will start the application with hot-reloading enabled. The server will be running at `http://localhost:3000`.

*   **Production mode:**
    ```bash
    npm run build
    npm run start:prod
    ```

*   **Running tests:**
    ```bash
    # unit tests
    npm run test

    # e2e tests
    npm run test:e2e

    # test coverage
    npm run test:cov
    ```

## üìñ API Reference

The API documentation is available at `http://localhost:3000/api` when the application is running. It is generated using Swagger.

## üèõÔ∏è Architecture Overview

This is a NestJS-based API that integrates with Google's Gemini AI. Here's a breakdown of its architecture:

### Core Architecture

*   **Framework:** The application is built on the **NestJS** framework, which provides a modular and structured approach to building server-side applications with TypeScript.
*   **Configuration:** It uses `@nestjs/config` for managing environment variables, which is evident from its import in `AppModule`. This allows for easy configuration of things like API keys.
*   **Entry Point:** The `main.ts` file is the application's entry point, responsible for bootstrapping the NestJS application.

### Modular Structure

The application follows a modular architecture, a key feature of NestJS:

*   **`AppModule`:** This is the root module of the application. It imports the `ConfigModule` to make environment variables available globally and the `GeminiModule`, which encapsulates all the Gemini-related functionality.
*   **`GeminiModule`:** This is a feature module that bundles all the components related to the Gemini AI integration. It declares the `GeminiController` to handle incoming requests and provides the `GeminiService` for business logic.

### Key Components

*   **`GeminiController`:** This is the API layer for the Gemini feature. It defines the routes for interacting with the Gemini AI, such as `/gemini/basic-prompt`, `/gemini/basic-prompt-assets`, and `/gemini/basic-prompt-stream`. It uses decorators for routing (`@Controller`, `@Post`), request body handling (`@Body`), and API documentation (`@ApiOperation`, `@ApiResponse`). It also handles file uploads with `@UseInterceptors(FilesInterceptor('files'))`.
*   **`GeminiService`:** This service contains the core business logic. It's responsible for interacting with the Google Generative AI SDK. It initializes the `GoogleGenAI` client with an API key from the environment variables. It has methods that correspond to the controller's endpoints, which in turn call specific use cases.
*   **Use Cases:** The business logic is further broken down into use cases like `basicPromptUseCase` and `basicPromptStreamUseCase`. This is a good practice for separating concerns and makes the code more maintainable and testable. These use cases directly interact with the `GoogleGenAI` client to generate content.
*   **DTOs (Data Transfer Objects):** The `BasicPromptDto` is used to define the shape of the data that the controller expects in the request body. This provides strong typing and validation.

### Functionality

*   **Basic Prompt:** The `/gemini/basic-prompt` endpoint takes a simple text prompt and returns a single response from the Gemini AI.
*   **Basic Prompt with Assets:** The `/gemini/basic-prompt-assets` endpoint allows you to send a prompt along with images or other files and returns a single response.
*   **Streaming Prompt:** The `/gemini/basic-prompt-stream` endpoint also takes a prompt but streams the response back to the client as it's being generated by the AI. This is useful for long-running requests where you want to provide a more responsive user experience. It also supports file uploads, allowing you to send images or other assets to the AI along with the prompt.

In summary, this is a well-structured NestJS application that follows best practices for building modular and maintainable APIs. It effectively encapsulates the logic for interacting with the Gemini AI into a dedicated module, with a clear separation of concerns between the controller, service, and use cases.